import"./Bzak7iHL.js";import{p as He,f as k,t as I,a as d,b as Be,o as ae,c as o,r as s,s as i,i as n,u as re,j as q,e as te,h as b,k as ye,d as xe,g as sr,M as Ye,ap as Ar,aq as Me}from"./jB7C_rnE.js";import{s as ke,c as er,b as Ne,a as ve,r as De,f as Mr}from"./CgC7qgJv.js";import{p as _e,l as ue,a as Ze,s as Pr}from"./D-VCVtW5.js";import{u as ur}from"./DJ2Os-o7.js";import{w as Oe,b as ce,p as rr,g as Er,d as We,s as L}from"./C8st8IW6.js";import"./69_IOA4Y.js";import{h as ge}from"./CiNhGnpg.js";import{g as Lr}from"./Bh8BaerV.js";import{p as Pe}from"./U6mOqqCz.js";import{i as p}from"./Bp5l5fH2.js";import{e as Ve,i as gr}from"./B_9GqA3w.js";import{M as $r}from"./CpzPGquC.js";import{T as mr}from"./CpfQv8U7.js";import{H as fr}from"./Deh6qM-2.js";import{S as zr}from"./D9oTCdqu.js";import{a as Fe}from"./CeoL9yOQ.js";import{d as or,b as Nr}from"./Bh8KIsK8.js";import{V as Hr,a as Br}from"./BEO6q_qa.js";import{U as br}from"./IYyS0das.js";var Or=k('<img width="60" height="40" src="/chatui-new/light/logo.svg"/>');function la(e,r){He(r,!0);const a=ur();let t=_e(r,"classNames",3,"");var u=Or();I(()=>{ke(u,1,er(t())),Ne(u,"alt",`${a.PUBLIC_APP_NAME??""} logo`)}),d(e,u),Be()}var Rr=ae('<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="none" viewBox="0 0 16 16"><path d="M7.258 1.856c.333 0 .66.024.979.07-.558.319-.972.86-1.123 1.503A5.254 5.254 0 1 0 9.32 13.513l.275-.127c.334-.17.712-.229 1.08-.17l.158.031.01.003 1.343.36-.359-1.345a1.77 1.77 0 0 1 .137-1.247 5.23 5.23 0 0 0 .538-2.041 2.356 2.356 0 0 0 1.544-1 6.808 6.808 0 0 1-.676 3.742v.001c-.034.066-.031.116-.025.14l.36 1.345a1.572 1.572 0 0 1-1.823 1.945l-.1-.024-1.334-.357a.2.2 0 0 0-.14.018l-.012.005A6.825 6.825 0 1 1 7.259 1.856Zm4.837-1.36c.434 0 .785.352.785.786v1.905h1.9a.785.785 0 0 1 0 1.57h-1.9v1.9a.786.786 0 1 1-1.57 0v-1.9H9.404a.785.785 0 0 1 0-1.57h1.906V1.282c0-.434.352-.787.785-.787Z" fill="currentColor"></path></svg>');function ia(e,r){let a=_e(r,"classNames",3,"");var t=Rr();I(()=>ke(t,0,er(a()))),d(e,t)}var jr=ae("<svg><!></svg>");function Dr(e,r){const a=ue(r,["children","$$slots","$$events","$$legacy"]);var t=jr();ve(t,()=>({viewBox:"0 0 32 32",width:"1.2em",height:"1.2em",...a}));var u=o(t);ge(u,()=>'<path fill="currentColor" d="M27 16.76v-1.53l1.92-1.68A2 2 0 0 0 29.3 11l-2.36-4a2 2 0 0 0-1.73-1a2 2 0 0 0-.64.1l-2.43.82a11 11 0 0 0-1.31-.75l-.51-2.52a2 2 0 0 0-2-1.61h-4.68a2 2 0 0 0-2 1.61l-.51 2.52a11.5 11.5 0 0 0-1.32.75l-2.38-.86A2 2 0 0 0 6.79 6a2 2 0 0 0-1.73 1L2.7 11a2 2 0 0 0 .41 2.51L5 15.24v1.53l-1.89 1.68A2 2 0 0 0 2.7 21l2.36 4a2 2 0 0 0 1.73 1a2 2 0 0 0 .64-.1l2.43-.82a11 11 0 0 0 1.31.75l.51 2.52a2 2 0 0 0 2 1.61h4.72a2 2 0 0 0 2-1.61l.51-2.52a11.5 11.5 0 0 0 1.32-.75l2.42.82a2 2 0 0 0 .64.1a2 2 0 0 0 1.73-1l2.28-4a2 2 0 0 0-.41-2.51ZM25.21 24l-3.43-1.16a8.9 8.9 0 0 1-2.71 1.57L18.36 28h-4.72l-.71-3.55a9.4 9.4 0 0 1-2.7-1.57L6.79 24l-2.36-4l2.72-2.4a8.9 8.9 0 0 1 0-3.13L4.43 12l2.36-4l3.43 1.16a8.9 8.9 0 0 1 2.71-1.57L13.64 4h4.72l.71 3.55a9.4 9.4 0 0 1 2.7 1.57L25.21 8l2.36 4l-2.72 2.4a8.9 8.9 0 0 1 0 3.13L27.57 20Z"/><path fill="currentColor" d="M16 22a6 6 0 1 1 6-6a5.94 5.94 0 0 1-6 6m0-10a3.91 3.91 0 0 0-4 4a3.91 3.91 0 0 0 4 4a3.91 3.91 0 0 0 4-4a3.91 3.91 0 0 0-4-4"/>',!0),s(t),d(e,t)}var Fr=ae('<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"><path d="m3.5 11.75l8.172-8.171a2.828 2.828 0 1 1 4 4m0 0L9.5 13.75m6.172-6.171a2.828 2.828 0 0 1 4 4l-6.965 6.964a1 1 0 0 0 0 1.414L14 21.25"></path><path d="m17.5 9.75l-6.172 6.171a2.829 2.829 0 0 1-4-4L13.5 5.749"></path></g></svg>');function Tr(e,r){let a=_e(r,"classNames",3,"");var t=Fr();I(()=>ke(t,0,er(a()))),d(e,t)}const da=Oe(!1);var Ur=ae("<svg><!></svg>");function ca(e,r){const a=ue(r,["children","$$slots","$$events","$$legacy"]);var t=Ur();ve(t,()=>({viewBox:"0 0 32 32",width:"1.2em",height:"1.2em",...a}));var u=o(t);ge(u,()=>'<path fill="currentColor" d="M2 26h28v2H2zM25.4 9c.8-.8.8-2 0-2.8l-3.6-3.6c-.8-.8-2-.8-2.8 0l-15 15V24h6.4zm-5-5L24 7.6l-3 3L17.4 7zM6 22v-3.6l10-10l3.6 3.6l-10 10z"/>',!0),s(t),d(e,t)}function va(){if(Pe.data.loginEnabled&&!Pe.data.user){const e=Pe.data.shared||Pe.url.pathname.startsWith(`${ce}/models/`)?`${ce}/login?next=${encodeURIComponent(Pe.url.pathname+Pe.url.search)}`:`${ce}/login`;return Lr(e,{invalidateAll:!0}),!0}return!1}const nr=globalThis.__sveltekit_1jk8j32.env;function hr(e){return(e||"").toLowerCase().replace(/[^a-z0-9_-]+/g,"-")}const Vr=hr(nr.PUBLIC_APP_ASSETS||nr.PUBLIC_APP_NAME),Jr=hr(typeof ce=="string"?ce:""),Ge=Vr||Jr||"app",Le={CUSTOM_SERVERS:`${Ge}:mcp:custom-servers`,SELECTED_IDS:`${Ge}:mcp:selected-ids`,DISABLED_BASE_IDS:`${Ge}:mcp:disabled-base-ids`};function Je(){try{const e=localStorage.getItem(Le.CUSTOM_SERVERS);return e?JSON.parse(e):[]}catch(e){return console.error("Failed to load custom MCP servers from localStorage:",e),[]}}function Wr(){try{const e=localStorage.getItem(Le.SELECTED_IDS),r=e?JSON.parse(e):[];return new Set(r)}catch(e){return console.error("Failed to load selected MCP server IDs from localStorage:",e),new Set}}function xr(e){try{localStorage.setItem(Le.CUSTOM_SERVERS,JSON.stringify(e))}catch(r){console.error("Failed to save custom MCP servers to localStorage:",r)}}function qr(e){try{localStorage.setItem(Le.SELECTED_IDS,JSON.stringify([...e]))}catch(r){console.error("Failed to save selected MCP server IDs to localStorage:",r)}}function Xe(){try{const e=localStorage.getItem(Le.DISABLED_BASE_IDS);return new Set(e?JSON.parse(e):[])}catch(e){return console.error("Failed to load disabled base MCP server IDs from localStorage:",e),new Set}}function Qe(e){try{localStorage.setItem(Le.DISABLED_BASE_IDS,JSON.stringify([...e]))}catch(r){console.error("Failed to save disabled base MCP server IDs to localStorage:",r)}}const we=Oe([]),lr=Oe(!1),pe=Oe(Wr());pe.subscribe(e=>{qr(e)});const Kr=rr([we,pe],([e,r])=>e.filter(a=>r.has(a.id))),Yr=rr(Kr,e=>e.length),ua=rr([we,pe],([e,r])=>{const a=e.filter(t=>t.type==="base");return a.length>0&&a.every(t=>r.has(t.id))});async function Ee(){try{const e=await fetch(`${ce}/api/mcp/servers`);if(!e.ok)throw new Error(`Failed to fetch base servers: ${e.statusText}`);const r=await e.json(),a=Je(),t=[...r,...a];we.set(t);const u=Xe(),H=new Set(t.map(S=>S.id));pe.update(S=>{const $=new Set;for(const g of r)u.has(g.id)||$.add(g.id);for(const g of S)H.has(g)&&!g.startsWith("base-")&&$.add(g);return $}),lr.set(!0)}catch(e){console.error("Failed to refresh MCP servers:",e),we.set(Je()),lr.set(!0)}}function Zr(e){pe.update(r=>{const a=new Set(r);if(a.has(e)){if(a.delete(e),e.startsWith("base-")){const t=Xe();t.add(e),Qe(t)}}else if(a.add(e),e.startsWith("base-")){const t=Xe();t.delete(e),Qe(t)}return a})}function ga(){const r=Er(we).filter(a=>a.type==="base").map(a=>a.id);Qe(new Set(r)),pe.set(new Set)}function Gr(e){const r={...e,id:crypto.randomUUID(),type:"custom",status:"disconnected"},a=Je();return a.push(r),xr(a),Ee(),r.id}function Xr(e){const a=Je().filter(t=>t.id!==e);xr(a),pe.update(t=>{const u=new Set(t);return u.delete(e),u}),Ee()}async function Qr(e){try{await fetch(`${ce}/api/mcp/local-config?name=${encodeURIComponent(e)}`,{method:"DELETE"})}catch(r){console.error("Failed to delete local MCP base server:",r)}await Ee()}function Te(e,r,a,t,u){we.update(H=>H.map(S=>S.id===e?{...S,status:r,errorMessage:a,tools:t,authRequired:u}:S))}async function pr(e){try{Te(e.id,"connecting");const a=await(await fetch(`${ce}/api/mcp/health`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:e.url,headers:e.headers})})).json();return a.ready&&a.tools?(Te(e.id,"connected",void 0,a.tools,!1),{ready:!0,tools:a.tools}):(Te(e.id,"error",a.error,void 0,!!a.authRequired),{ready:!1,error:a.error})}catch(r){const a=r instanceof Error?r.message:"Unknown error";return Te(e.id,"error",a),{ready:!1,error:a}}}Ee();var et=ae("<svg><!></svg>");function ir(e,r){const a=ue(r,["children","$$slots","$$events","$$legacy"]);var t=et();ve(t,()=>({viewBox:"0 0 32 32",width:"1.2em",height:"1.2em",...a}));var u=o(t);ge(u,()=>'<path fill="currentColor" d="M16 2a14 14 0 1 0 14 14A14 14 0 0 0 16 2m-2 19.59l-5-5L10.59 15L14 18.41L21.41 11l1.596 1.586Z"/><path fill="none" d="m14 21.591l-5-5L10.591 15L14 18.409L21.41 11l1.595 1.585z"/>',!0),s(t),d(e,t)}var rt=ae("<svg><!></svg>");function dr(e,r){const a=ue(r,["children","$$slots","$$events","$$legacy"]);var t=rt();ve(t,()=>({viewBox:"0 0 32 32",width:"1.2em",height:"1.2em",...a}));var u=o(t);ge(u,()=>'<path fill="currentColor" d="M16 2C8.3 2 2 8.3 2 16s6.3 14 14 14s14-6.3 14-14S23.7 2 16 2m-1.1 6h2.2v11h-2.2zM16 25c-.8 0-1.5-.7-1.5-1.5S15.2 22 16 22s1.5.7 1.5 1.5S16.8 25 16 25"/>',!0),s(t),d(e,t)}var tt=ae("<svg><!></svg>");function Ue(e,r){const a=ue(r,["children","$$slots","$$events","$$legacy"]);var t=tt();ve(t,()=>({viewBox:"0 0 32 32",width:"1.2em",height:"1.2em",...a}));var u=o(t);ge(u,()=>'<path fill="currentColor" d="M16 2a14 14 0 1 0 14 14A14 14 0 0 0 16 2M8 18a2 2 0 1 1 2-2a2 2 0 0 1-2 2m8 0a2 2 0 1 1 2-2a2 2 0 0 1-2 2m8 0a2 2 0 1 1 2-2a2 2 0 0 1-2 2"/><path fill="none" d="M10 16a2 2 0 1 1-2-2a2 2 0 0 1 2 2m6-2a2 2 0 1 0 2 2a2 2 0 0 0-2-2m8 0a2 2 0 1 0 2 2a2 2 0 0 0-2-2"/>',!0),s(t),d(e,t)}var at=ae("<svg><!></svg>");function yr(e,r){const a=ue(r,["children","$$slots","$$events","$$legacy"]);var t=at();ve(t,()=>({viewBox:"0 0 32 32",width:"1.2em",height:"1.2em",...a}));var u=o(t);ge(u,()=>'<path fill="currentColor" d="M12 10H6.78A11 11 0 0 1 27 16h2A13 13 0 0 0 6 7.68V4H4v8h8zm8 12h5.22A11 11 0 0 1 5 16H3a13 13 0 0 0 23 8.32V28h2v-8h-8z"/>',!0),s(t),d(e,t)}function st(e,r=64){try{const a=new URL(e),t=a.hostname.split("."),u=t.length>=2?t.slice(-2).join("."):a.hostname,H=`${a.protocol}//${u}`;return`https://www.google.com/s2/favicons?sz=${r}&domain_url=${encodeURIComponent(H)}`}catch{return`https://www.google.com/s2/favicons?sz=${r}&domain_url=${encodeURIComponent(e)}`}}function ot(e){try{const r=new URL(e),a=r.hostname.toLowerCase(),t=new Set(["hf.co","huggingface.co"]);return r.protocol==="https:"&&t.has(a)&&r.pathname==="/mcp"&&r.search==="?login"}catch{return!1}}var nt=k('<span class="inline-flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400"><!> </span>'),lt=k('<div class="mb-2 flex items-center gap-2"><span><!> </span> <!></div>'),it=k('<div class="mb-2 flex items-center gap-2"><div class="line-clamp-6 break-words rounded bg-red-50 px-2 py-1 text-xs text-red-800 dark:bg-red-900/20 dark:text-red-200"> </div></div>'),dt=k('<a href="https://huggingface.co/settings/mcp" target="_blank" rel="noopener noreferrer" class="flex items-center gap-1.5 rounded-lg border border-gray-200 bg-white px-2.5 py-[.29rem] text-xs font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600" aria-label="Open Hugging Face MCP settings"><!> Settings</a>'),ct=k('<button class="flex items-center gap-1.5 rounded-lg border border-red-500/15 bg-red-50 px-2.5 py-[.29rem] text-xs font-medium text-red-600 hover:bg-red-100 dark:border-red-500/25 dark:bg-red-900/30 dark:text-red-400 dark:hover:bg-red-900/50"><!> Delete</button>'),vt=k('<span class="text-gray-500 dark:text-gray-500"> </span>'),ut=k('<li class="text-gray-600 dark:text-gray-400"><span class="font-medium text-gray-900 dark:text-gray-100"> </span> <!></li>'),gt=k('<details class="mt-3"><summary class="cursor-pointer text-xs font-medium text-gray-700 dark:text-gray-300"> </summary> <ul class="mt-2 space-y-1 text-xs"></ul></details>'),mt=k('<div><div class="px-4 py-3.5"><div class="mb-3 flex items-start justify-between gap-3"><div class="min-w-0 flex-1"><div class="mb-0.5 flex items-center gap-2"><img alt="" class="size-4 flex-shrink-0 rounded"/> <h3 class="truncate font-semibold text-gray-900 dark:text-gray-100"> </h3></div> <p class="truncate text-sm text-gray-600 dark:text-gray-400"> </p></div> <!></div> <!> <!> <div class="flex flex-wrap gap-1"><button class="flex items-center gap-1.5 rounded-lg border border-gray-200 bg-white px-2.5 py-[.29rem] text-xs font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"><!> Health Check</button> <!> <!></div> <!></div></div>');function cr(e,r){He(r,!0);let a=te(!1);const t=re(()=>ot(r.server.url)),u=re(()=>{switch(r.server.status){case"connected":return{label:"Connected",color:"text-green-600 dark:text-green-400",bgColor:"bg-green-100 dark:bg-green-900/20",icon:ir};case"connecting":return{label:"Connecting...",color:"text-blue-600 dark:text-blue-400",bgColor:"bg-blue-100 dark:bg-blue-900/20",icon:Ue};case"error":return{label:"Error",color:"text-red-600 dark:text-red-400",bgColor:"bg-red-100 dark:bg-red-900/20",icon:dr};case"disconnected":default:return{label:"Unknown",color:"text-gray-600 dark:text-gray-400",bgColor:"bg-gray-100 dark:bg-gray-700",icon:Ue}}});function H(l){l!==r.isSelected&&(Zr(r.server.id),l&&r.server.status!=="connected"&&S())}async function S(){b(a,!0);try{await pr(r.server)}finally{b(a,!1)}}function $(){if(r.server.type==="custom")Xr(r.server.id);else if(r.server.id.startsWith("local-")){const l=r.server.id.slice(6)||r.server.name;Qr(l)}}var g=mt(),w=o(g),P=o(w),j=o(P),K=o(j),se=o(K),oe=i(se,2),Y=o(oe,!0);s(oe),s(K);var V=i(K,2),ne=o(V,!0);s(V),s(j);var E=i(j,2),A=()=>r.isSelected,de=H;{let l=re(()=>`enable-${r.server.id}`);zr(E,{get name(){return n(l)},get checked(){return A()},set checked(c){de(c)}})}s(P);var D=i(P,2);{var Z=l=>{var c=lt(),h=o(c),v=o(h);{var f=_=>{ir(_,{class:"size-3"})},m=_=>{var O=ye(),J=xe(O);{var R=U=>{Ue(U,{class:"size-3"})},T=U=>{var me=ye(),fe=xe(me);{var X=le=>{dr(le,{class:"size-3"})},Q=le=>{Ue(le,{class:"size-3"})};p(fe,le=>{r.server.status==="error"?le(X):le(Q,!1)},!0)}d(U,me)};p(J,U=>{r.server.status==="connecting"?U(R):U(T,!1)},!0)}d(_,O)};p(v,_=>{r.server.status==="connected"?_(f):_(m,!1)})}var x=i(v);s(h);var N=i(h,2);{var z=_=>{var O=nt(),J=o(O);fr(J,{class:"size-3"});var R=i(J);s(O),I(()=>L(R,` ${r.server.tools.length??""}
						${r.server.tools.length===1?"tool":"tools"}`)),d(_,O)};p(N,_=>{r.server.tools&&r.server.tools.length>0&&_(z)})}s(c),I(()=>{ke(h,1,`inline-flex items-center gap-1 rounded-full ${n(u).bgColor??""} py-0.5 pl-1.5 pr-2 text-xs font-medium ${n(u).color??""}`),L(x,` ${n(u).label??""}`)}),d(l,c)};p(D,l=>{r.server.status&&l(Z)})}var F=i(D,2);{var y=l=>{var c=it(),h=o(c),v=o(h,!0);s(h),s(c),I(()=>L(v,r.server.errorMessage)),d(l,c)};p(F,l=>{r.server.errorMessage&&l(y)})}var C=i(F,2),M=o(C);M.__click=S;var B=o(M);{let l=re(()=>n(a)?"animate-spin":"");yr(B,{get class(){return`size-3 ${n(l)??""}`}})}q(),s(M);var G=i(M,2);{var Se=l=>{var c=dt(),h=o(c);Dr(h,{class:"size-3"}),q(),s(c),d(l,c)};p(G,l=>{n(t)&&l(Se)})}var $e=i(G,2);{var Ce=l=>{var c=ct();c.__click=$;var h=o(c);mr(h,{class:"size-3"}),q(),s(c),d(l,c)};p($e,l=>{(r.server.type==="custom"||r.server.id.startsWith("local-"))&&l(Ce)})}s(C);var ze=i(C,2);{var Ie=l=>{var c=gt(),h=o(c),v=o(h);s(h);var f=i(h,2);Ve(f,21,()=>r.server.tools,gr,(m,x)=>{var N=ut(),z=o(N),_=o(z,!0);s(z);var O=i(z,2);{var J=R=>{var T=vt(),U=o(T);s(T),I(()=>L(U,`- ${n(x).description??""}`)),d(R,T)};p(O,R=>{n(x).description&&R(J)})}s(N),I(()=>L(_,n(x).name)),d(m,N)}),s(f),s(c),I(()=>L(v,`Available Tools (${r.server.tools.length??""})`)),d(l,c)};p(ze,l=>{r.server.tools&&r.server.tools.length>0&&l(Ie)})}s(w),s(g),I(l=>{ke(g,1,`rounded-lg border bg-gradient-to-br transition-colors ${r.isSelected?"border-blue-600/20 bg-blue-50 from-blue-500/5 to-transparent dark:border-blue-700/60 dark:bg-blue-900/10 dark:from-blue-900/20":"border-gray-200 bg-white from-black/5 dark:border-gray-700 dark:bg-gray-800 dark:from-white/5"}`),Ne(se,"src",l),L(Y,r.server.name),L(ne,r.server.url),M.disabled=n(a)},[()=>st(r.server.url)]),d(e,g),Be()}We(["click"]);function ft(e){if(!e||typeof e!="string")return null;try{const r=new URL(e.trim());return["http:","https:"].includes(r.protocol)?(!or&&r.protocol==="http:"&&Nr&&console.warn("Warning: Connecting to non-HTTPS MCP server in production. This may expose sensitive data."),!or&&bt(r.hostname)&&console.warn("Warning: Localhost/private IP addresses are not recommended in production."),r.toString()):null}catch{return null}}function bt(e){return!!(e==="localhost"||e==="127.0.0.1"||e==="::1"||e.endsWith(".localhost")||/^(10\.|172\.(1[6-9]|2[0-9]|3[01])\.|192\.168\.|127\.|0\.0\.0\.0|169\.254\.)/.test(e))}function ht(e){const r=["authorization","api-key","api_key","apikey","token","secret","password","bearer","x-api-key","x-auth-token"],a=e.toLowerCase();return r.some(t=>a.includes(t))}function xt(e,r){return!e||!e.trim()?"Header name is required":/^[a-zA-Z0-9_-]+$/.test(e)?r?null:"Header value is required":"Header name can only contain letters, numbers, hyphens, and underscores"}var pt=ae("<svg><!></svg>");function yt(e,r){const a=ue(r,["children","$$slots","$$events","$$legacy"]);var t=pt();ve(t,()=>({viewBox:"0 0 32 32",width:"1.2em",height:"1.2em",...a}));var u=o(t);ge(u,()=>'<path fill="currentColor" d="M17 15V8h-2v7H8v2h7v7h2v-7h7v-2z"/>',!0),s(t),d(e,t)}var _t=ae("<svg><!></svg>");function _r(e,r){const a=ue(r,["children","$$slots","$$events","$$legacy"]);var t=_t();ve(t,()=>({viewBox:"0 0 32 32",width:"1.2em",height:"1.2em",...a}));var u=o(t);ge(u,()=>'<path fill="currentColor" d="M16 2a14 14 0 1 0 14 14A14 14 0 0 0 16 2m0 26a12 12 0 1 1 12-12a12 12 0 0 1-12 12"/><path fill="currentColor" d="M15 8h2v11h-2zm1 14a1.5 1.5 0 1 0 1.5 1.5A1.5 1.5 0 0 0 16 22"/>',!0),s(t),d(e,t)}var kt=k('<p class="text-sm text-gray-500 dark:text-gray-400">No headers configured</p>'),wt=k('<button type="button" class="absolute right-2 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"><!></button>'),St=k('<div class="flex gap-2"><input placeholder="Header name (e.g., Authorization)" class="flex-1 rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm dark:border-gray-600 dark:bg-gray-700 dark:text-white"/> <div class="relative flex-1"><input placeholder="Value" class="w-full rounded-lg border border-gray-300 bg-white px-3 py-2 pr-10 text-sm dark:border-gray-600 dark:bg-gray-700 dark:text-white"/> <!></div> <button type="button" class="rounded-lg bg-red-100 p-2 text-red-600 hover:bg-red-200 dark:bg-red-900/30 dark:text-red-400 dark:hover:bg-red-900/50" title="Remove header"><!></button></div>'),Ct=k('<div class="rounded-lg border border-red-200 bg-red-50 p-3 dark:border-red-800 dark:bg-red-900/20"><p class="text-sm text-red-800 dark:text-red-200"> </p></div>'),It=k(`<div class="space-y-4"><div><label for="server-name" class="mb-1 block text-sm font-medium text-gray-700 dark:text-gray-300">Server Name <span class="text-red-500">*</span></label> <input id="server-name" type="text" placeholder="My MCP Server" class="mt-1.5 w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm dark:border-gray-600 dark:bg-gray-700 dark:text-white"/></div> <div><label for="server-url" class="mb-1 block text-sm font-medium text-gray-700 dark:text-gray-300">Server URL <span class="text-red-500">*</span></label> <input id="server-url" type="url" placeholder="https://example.com/mcp" class="mt-1.5 w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm dark:border-gray-600 dark:bg-gray-700 dark:text-white"/></div> <details class="rounded-lg border border-gray-200 dark:border-gray-700"><summary class="cursor-pointer px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300">HTTP Headers (Optional)</summary> <div class="space-y-2 border-t border-gray-200 p-4 dark:border-gray-700"><!> <button type="button" class="flex items-center gap-1.5 rounded-lg bg-gray-100 px-3 py-1.5 text-sm font-medium text-gray-700 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"><!> Add Header</button> <p class="text-xs text-gray-500 dark:text-gray-400">Common examples:<br/> â€¢ Bearer token: <code class="rounded bg-gray-100 px-1 dark:bg-gray-700">Authorization: Bearer YOUR_TOKEN</code><br/> â€¢ API key: <code class="rounded bg-gray-100 px-1 dark:bg-gray-700">X-API-Key: YOUR_KEY</code></p></div></details> <div class="rounded-lg border border-stone-200 bg-stone-50 p-3 text-stone-900 dark:border-yellow-900/40 dark:bg-yellow-900/20 dark:text-yellow-100"><div class="flex items-start gap-3"><!> <div class="text-sm leading-5"><p class="font-medium">Be careful with custom MCP servers.</p> <p class="mt-1 text-[13px] text-stone-800 dark:text-yellow-100/90">They receive your requests (including conversation context and any headers you add) and
					can run powerful tools on your behalf. Only add servers you trust and review their source.
					Never share confidental informations.</p></div></div></div> <!> <div class="flex justify-end gap-2"><button type="button" class="rounded-lg bg-gray-200 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600">Cancel</button> <button type="button" class="rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-600"> </button></div></div>`);function At(e,r){He(r,!0);let a=_e(r,"initialName",3,""),t=_e(r,"initialUrl",3,""),u=_e(r,"initialHeaders",19,()=>[]),H=_e(r,"submitLabel",3,"Add Server"),S=te(""),$=te(""),g=te(sr([])),w=te(sr({})),P=te(null);Ye(()=>{b(S,a())}),Ye(()=>{b($,t())}),Ye(()=>{b(g,u().length>0?[...u()]:[],!0)});function j(){b(g,[...n(g),{key:"",value:""}],!0)}function K(v){b(g,n(g).filter((f,m)=>m!==v),!0),delete n(w)[v]}function se(v){b(w,{...n(w),[v]:!n(w)[v]},!0)}function oe(){if(!n(S).trim())return b(P,"Server name is required"),!1;if(!n($).trim())return b(P,"Server URL is required"),!1;if(!ft(n($)))return b(P,"Invalid URL."),!1;for(let f=0;f<n(g).length;f++){const m=n(g)[f];if(m.key.trim()||m.value.trim()){const x=xt(m.key,m.value);if(x)return b(P,`Header ${f+1}: ${x}`),!1}}return b(P,null),!0}function Y(){if(!oe())return;const v=n(g).filter(f=>f.key.trim()&&f.value.trim());r.onsubmit({name:n(S).trim(),url:n($).trim(),headers:v.length>0?v:void 0})}var V=It(),ne=o(V),E=i(o(ne),2);De(E),s(ne);var A=i(ne,2),de=i(o(A),2);De(de),s(A);var D=i(A,2),Z=i(o(D),2),F=o(Z);{var y=v=>{var f=kt();d(v,f)},C=v=>{var f=ye(),m=xe(f);Ve(m,17,()=>n(g),gr,(x,N,z)=>{var _=St(),O=o(_);De(O);var J=i(O,2),R=o(J);De(R);var T=i(R,2);{var U=X=>{var Q=wt();Q.__click=()=>se(z);var le=o(Q);{var Re=be=>{Hr(be,{class:"size-4"})},je=be=>{Br(be,{class:"size-4"})};p(le,be=>{n(w)[z]?be(Re):be(je,!1)})}s(Q),I(()=>Ne(Q,"title",n(w)[z]?"Hide value":"Show value")),d(X,Q)};p(T,X=>{ht(n(N).key)&&X(U)})}s(J);var me=i(J,2);me.__click=()=>K(z);var fe=o(me);mr(fe,{class:"size-4"}),s(me),s(_),I(()=>Ne(R,"type",n(w)[z]?"text":"password")),Fe(O,()=>n(N).key,X=>n(N).key=X),Fe(R,()=>n(N).value,X=>n(N).value=X),d(x,_)}),d(v,f)};p(F,v=>{n(g).length===0?v(y):v(C,!1)})}var M=i(F,2);M.__click=j;var B=o(M);yt(B,{class:"size-4"}),q(),s(M),q(2),s(Z),s(D);var G=i(D,2),Se=o(G),$e=o(Se);_r($e,{class:"mt-0.5 size-4 flex-none text-stone-600 dark:text-yellow-300"}),q(2),s(Se),s(G);var Ce=i(G,2);{var ze=v=>{var f=Ct(),m=o(f),x=o(m,!0);s(m),s(f),I(()=>L(x,n(P))),d(v,f)};p(Ce,v=>{n(P)&&v(ze)})}var Ie=i(Ce,2),l=o(Ie);l.__click=function(...v){var f;(f=r.oncancel)==null||f.apply(this,v)};var c=i(l,2);c.__click=Y;var h=o(c,!0);s(c),s(Ie),s(V),I(()=>L(h,H())),Fe(E,()=>n(S),v=>b(S,v)),Fe(de,()=>n($),v=>b($,v)),d(e,V),Be()}We(["click"]);var Mt=k('<div class="rounded-lg border border-red-200 bg-red-50 p-3 dark:border-red-800 dark:bg-red-900/20"><p class="text-sm text-red-800 dark:text-red-200"> </p></div>'),Pt=k(`<div class="space-y-4"><div><label for="file-upload" class="mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300">Upload JSON File</label> <label for="file-upload" class="flex cursor-pointer items-center justify-center rounded-lg border-2 border-dashed border-gray-300 bg-gray-50 p-6 transition-colors hover:border-blue-500 hover:bg-blue-50 dark:border-gray-600 dark:bg-gray-800 dark:hover:border-blue-500 dark:hover:bg-blue-900/20"><div class="text-center"><!> <p class="text-sm text-gray-600 dark:text-gray-400">Click to upload or drag and drop</p> <p class="text-xs text-gray-500 dark:text-gray-500">mcp_config.json or similar</p></div> <input id="file-upload" type="file" accept=".json" class="hidden"/></label></div> <div class="relative"><div class="absolute inset-0 flex items-center"><div class="w-full border-t border-gray-300 dark:border-gray-600"></div></div> <div class="relative flex justify-center text-sm"><span class="bg-white px-2 text-gray-500 dark:bg-gray-900 dark:text-gray-400">or</span></div></div> <div><label for="json-text" class="mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300">Paste JSON Configuration</label> <textarea id="json-text" rows="12" class="w-full rounded-lg border border-gray-300 bg-white p-3 font-mono text-sm dark:border-gray-600 dark:bg-gray-700 dark:text-white"></textarea></div> <div class="rounded-lg border border-stone-200 bg-stone-50 p-3 text-stone-900 dark:border-yellow-900/40 dark:bg-yellow-900/20 dark:text-yellow-100"><div class="flex items-start gap-3"><!> <div class="text-sm leading-5"><p class="font-medium">Important Security Notice</p> <p class="mt-1 text-[13px] text-stone-800 dark:text-yellow-100/90">This will run commands on your server. Only import configurations from trusted sources.
					Malicious configurations can execute arbitrary code.</p></div></div></div> <!> <div class="flex justify-end gap-2"><button type="button" class="rounded-lg bg-gray-200 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600">Cancel</button> <button type="button" class="rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700 disabled:opacity-50"></button></div></div>`);function Et(e,r){He(r,!0);let a=te(""),t=te(null),u=!1;function H(y){const C=y.target;b(a,C.value,!0),b(t,null)}async function S(y){var B;const M=(B=y.target.files)==null?void 0:B[0];if(M)try{const G=await M.text();b(a,G,!0),b(t,null)}catch{b(t,"Failed to read file")}}function $(){if(!n(a).trim()){b(t,"Please provide JSON configuration");return}try{const y=JSON.parse(n(a));if(!y||typeof y!="object"||!y.mcpServers){b(t,'Invalid format. Expected: { "mcpServers": {...} }');return}for(const[C,M]of Object.entries(y.mcpServers)){const B=M;if(!B.command||typeof B.command!="string"){b(t,`Server "${C}": command is required`);return}if(!Array.isArray(B.args)){b(t,`Server "${C}": args must be an array`);return}}b(t,null),r.onsubmit(y)}catch{b(t,"Invalid JSON format")}}var g=Pt(),w=o(g),P=i(o(w),2),j=o(P),K=o(j);br(K,{class:"mx-auto mb-2 size-8 text-gray-400"}),q(4),s(j);var se=i(j,2);se.__change=S,s(P),s(w);var oe=i(w,4),Y=i(o(oe),2);Ar(Y),Y.__input=H,Ne(Y,"placeholder",`{
  "mcpServers": {
    "time": {
      "command": "uvx",
      "args": ["mcp-server-time"]
    },
    "mongodb": {
      "command": "npx",
      "args": ["-y", "mongodb-mcp-server"],
      "env": {
        "MDB_MCP_CONNECTION_STRING": "mongodb://..."
      }
    }
  }
}`),s(oe);var V=i(oe,2),ne=o(V),E=o(ne);_r(E,{class:"mt-0.5 size-4 flex-none text-stone-600 dark:text-yellow-300"}),q(2),s(ne),s(V);var A=i(V,2);{var de=y=>{var C=Mt(),M=o(C),B=o(M,!0);s(M),s(C),I(()=>L(B,n(t))),d(y,C)};p(A,y=>{n(t)&&y(de)})}var D=i(A,2),Z=o(D);Z.__click=function(...y){var C;(C=r.oncancel)==null||C.apply(this,y)};var F=i(Z,2);F.__click=$,F.disabled=u,F.textContent="Import Configuration",s(D),s(g),I(()=>Mr(Y,n(a))),d(e,g),Be()}We(["change","input","click"]);var Lt=ae("<svg><!></svg>");function vr(e,r){const a=ue(r,["children","$$slots","$$events","$$legacy"]);var t=Lt();ve(t,()=>({viewBox:"0 0 32 32",width:"1.2em",height:"1.2em",...a}));var u=o(t);ge(u,()=>'<path fill="currentColor" d="M17 15V5h-2v10H5v2h10v10h2V17h10v-2z"/>',!0),s(t),d(e,t)}var $t=k('<div><h3 class="mb-3 text-sm font-medium text-gray-700 dark:text-gray-300"> </h3> <div class="grid grid-cols-1 gap-3 md:grid-cols-2"></div></div>'),zt=k('<div class="flex flex-col items-center justify-center rounded-lg border-2 border-dashed border-gray-300 p-8 dark:border-gray-700"><!> <p class="mb-1 text-sm font-medium text-gray-900 dark:text-gray-100">No custom servers yet</p> <p class="mb-4 text-xs text-gray-600 dark:text-gray-400">Add your own MCP servers with custom tools</p> <button class="flex items-center gap-1.5 rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-600"><!> Add Your First Server</button></div>'),Nt=k('<div class="grid grid-cols-1 gap-3 md:grid-cols-2"></div>'),Ht=k('<div><div class="flex items-center gap-3"><div><!></div> <div><p class="text-sm font-semibold text-gray-900 dark:text-gray-100"> </p> <p class="text-xs text-gray-600 dark:text-gray-400"> </p></div></div> <div class="flex w-full flex-wrap justify-end gap-2"><button class="btn gap-1.5 rounded-lg border border-gray-200 bg-white px-3 py-1.5 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700"><!> </button> <button class="btn flex items-center gap-1.5 rounded-lg border border-gray-200 bg-white px-3 py-1.5 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700"><!> Import JSON</button> <button class="btn flex items-center gap-0.5 rounded-lg bg-blue-600 py-1.5 pl-2 pr-3 text-sm font-medium text-white hover:bg-blue-600"><!> Add Server</button></div></div> <div class="space-y-5"><!> <div><h3 class="mb-3 text-sm font-medium text-gray-700 dark:text-gray-300"> </h3> <!></div> <div class="rounded-lg bg-gray-50 p-4 dark:bg-gray-700"><h4 class="mb-2 text-sm font-medium text-gray-900 dark:text-gray-100">ðŸ’¡ Quick Tips</h4> <ul class="space-y-1 text-xs text-gray-600 dark:text-gray-400"><li>â€¢ Only connect to servers you trust</li> <li>â€¢ Enable servers to make their tools available in chat</li> <li>â€¢ Use the Health Check button to verify server connectivity</li> <li>â€¢ You can add HTTP headers for authentication when required</li></ul></div></div>',1),Bt=k('<div class="p-6"><div class="mb-6"><h2 class="mb-1 text-xl font-semibold text-gray-900 dark:text-gray-200"><!></h2> <p class="text-sm text-gray-600 dark:text-gray-400"><!></p></div> <!></div>');function ma(e,r){He(r,!0);const a=()=>Ze(we,"$allMcpServers",H),t=()=>Ze(Yr,"$enabledServersCount",H),u=()=>Ze(pe,"$selectedServerIds",H),[H,S]=Pr(),$=ur();let g=te("list"),w=te(!1),P=te(!1);const j=re(()=>a().filter(E=>E.type==="base")),K=re(()=>a().filter(E=>E.type==="custom")),se=re(t);function oe(E){Gr(E),b(g,"list")}function Y(){b(g,"list")}async function V(){if(!n(w)){b(w,!0);try{await Ee();const E=a();await Promise.allSettled(E.map(A=>pr(A)))}finally{b(w,!1)}}}async function ne(E){if(!n(P)){b(P,!0);try{const A=await fetch(`${ce}/api/mcp/local-config`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(E)});if(!A.ok){const de=await A.text();throw new Error(de||"Failed to import configuration")}await Ee(),b(g,"list")}catch(A){console.error("Failed to import config:",A),alert(`Failed to import configuration: ${A instanceof Error?A.message:"Unknown error"}`)}finally{b(P,!1)}}}{let E=re(()=>n(g)==="list"?"w-full max-w-[800px] sm:w-[600px] md:w-[800px]":"w-full max-w-[600px] sm:w-[500px] md:w-[600px]");$r(e,{get width(){return n(E)},get onclose(){return r.onclose},closeButton:!0,children:(A,de)=>{var D=Bt(),Z=o(D),F=o(Z),y=o(F);{var C=l=>{var c=Me("MCP Servers");d(l,c)},M=l=>{var c=ye(),h=xe(c);{var v=m=>{var x=Me("Add MCP server");d(m,x)},f=m=>{var x=Me("Import MCP Configuration");d(m,x)};p(h,m=>{n(g)==="add"?m(v):m(f,!1)},!0)}d(l,c)};p(y,l=>{n(g)==="list"?l(C):l(M,!1)})}s(F);var B=i(F,2),G=o(B);{var Se=l=>{var c=Me();I(()=>L(c,`Manage MCP servers to extend ${$.PUBLIC_APP_NAME??""} with external tools.`)),d(l,c)},$e=l=>{var c=ye(),h=xe(c);{var v=m=>{var x=Me();I(()=>L(x,`Add a custom MCP server to ${$.PUBLIC_APP_NAME??""}.`)),d(m,x)},f=m=>{var x=Me("Import local MCP servers from JSON configuration (Windsurf/VS Code format).");d(m,x)};p(h,m=>{n(g)==="add"?m(v):m(f,!1)},!0)}d(l,c)};p(G,l=>{n(g)==="list"?l(Se):l($e,!1)})}s(B),s(Z);var Ce=i(Z,2);{var ze=l=>{var c=Ht(),h=xe(c),v=o(h),f=o(v);let m;var x=o(f);Tr(x,{classNames:"size-8 text-blue-600 dark:text-blue-500"}),s(f);var N=i(f,2),z=o(N),_=o(z);s(z);var O=i(z,2),J=o(O);s(O),s(N),s(v);var R=i(v,2),T=o(R);T.__click=V;var U=o(T);{let W=re(()=>n(w)?"animate-spin":"");yr(U,{get class(){return`size-4 ${n(W)??""}`}})}var me=i(U);s(T);var fe=i(T,2);fe.__click=()=>b(g,"import");var X=o(fe);br(X,{class:"size-4"}),q(),s(fe);var Q=i(fe,2);Q.__click=()=>b(g,"add");var le=o(Q);vr(le,{class:"size-4"}),q(),s(Q),s(R),s(h);var Re=i(h,2),je=o(Re);{var be=W=>{var ee=$t(),ie=o(ee),he=o(ie);s(ie);var Ae=i(ie,2);Ve(Ae,21,()=>n(j),Ke=>Ke.id,(Ke,ar)=>{{let Ir=re(()=>u().has(n(ar).id));cr(Ke,{get server(){return n(ar)},get isSelected(){return n(Ir)}})}}),s(Ae),s(ee),I(()=>L(he,`Base Servers (${n(j).length??""})`)),d(W,ee)};p(je,W=>{n(j).length>0&&W(be)})}var tr=i(je,2),qe=o(tr),kr=o(qe);s(qe);var wr=i(qe,2);{var Sr=W=>{var ee=zt(),ie=o(ee);fr(ie,{class:"mb-3 size-12 text-gray-400"});var he=i(ie,6);he.__click=()=>b(g,"add");var Ae=o(he);vr(Ae,{class:"size-4"}),q(),s(he),s(ee),d(W,ee)},Cr=W=>{var ee=Nt();Ve(ee,21,()=>n(K),ie=>ie.id,(ie,he)=>{{let Ae=re(()=>u().has(n(he).id));cr(ie,{get server(){return n(he)},get isSelected(){return n(Ae)}})}}),s(ee),d(W,ee)};p(wr,W=>{n(K).length===0?W(Sr):W(Cr,!1)})}s(tr),q(2),s(Re),I(()=>{ke(h,1,`mb-6 flex justify-between rounded-lg p-4 max-sm:flex-col max-sm:gap-4 sm:items-center ${n(se)?"bg-blue-50 dark:bg-blue-900/10":"bg-gray-100 dark:bg-white/5"}`),m=ke(f,1,"flex size-10 items-center justify-center rounded-xl bg-blue-500/10",null,m,{grayscale:!n(se)}),L(_,`${a().length??""}
							${a().length===1?"server":"servers"} configured`),L(J,`${n(se)??""} enabled`),T.disabled=n(w),L(me,` ${n(w)?"Refreshingâ€¦":"Refresh"}`),L(kr,`Custom Servers (${n(K).length??""})`)}),d(l,c)},Ie=l=>{var c=ye(),h=xe(c);{var v=m=>{At(m,{onsubmit:oe,oncancel:Y})},f=m=>{var x=ye(),N=xe(x);{var z=_=>{Et(_,{onsubmit:ne,oncancel:Y})};p(N,_=>{n(g)==="import"&&_(z)},!0)}d(m,x)};p(h,m=>{n(g)==="add"?m(v):m(f,!1)},!0)}d(l,c)};p(Ce,l=>{n(g)==="list"?l(ze):l(Ie,!1)})}s(D),d(A,D)},$$slots:{default:!0}})}Be(),S()}We(["click"]);function Ot(){const{subscribe:e,set:r}=Oe(!1);return{subscribe:e,open:()=>r(!0),close:()=>r(!1)}}const fa=Ot();var Rt=(e=>(e.Status="status",e.Title="title",e.Tool="tool",e.Stream="stream",e.File="file",e.FinalAnswer="finalAnswer",e.Reasoning="reasoning",e.RouterMetadata="routerMetadata",e))(Rt||{}),jt=(e=>(e.Started="started",e.Error="error",e.Finished="finished",e.KeepAlive="keepAlive",e))(jt||{}),Dt=(e=>(e.Call="call",e.Result="result",e.Error="error",e.ETA="eta",e))(Dt||{});export{ca as E,ia as I,la as L,Rt as M,Dr as S,jt as a,Tr as b,ma as c,Yr as d,Kr as e,pe as f,st as g,we as h,da as i,ga as j,Dt as k,ua as l,lr as m,va as r,fa as s,Zr as t};
