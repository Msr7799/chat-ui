import{i as d}from"./Bh8BaerV.js";import{w as g,g as o,b as f}from"./C8st8IW6.js";import{as as T,R as b}from"./jB7C_rnE.js";var u=(s=>(s.ConversationList="conversation:list",s.Conversation="conversation:id",s))(u||{});function x(){return b("settings")}function L(s){const t=g({...s,recentlySaved:!1});let r,a=!1;async function S(n){t.update(e=>({...e,...n})),a=!0,clearTimeout(r),r=setTimeout(async()=>{await fetch(`${f}/settings`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o(t))}),d(u.ConversationList),a&&(t.update(e=>({...e,recentlySaved:!0})),setTimeout(()=>{t.update(e=>({...e,recentlySaved:!1}))},3e3)),a=!1},300)}async function p(n,e,m){const c=o(t)[n];if((c==null?void 0:c[e])!==void 0)return;const v={...c||{},[e]:m};t.update(i=>({...i,[n]:v})),clearTimeout(r),r=setTimeout(async()=>{await fetch(`${f}/settings`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o(t))}),d(u.ConversationList),a&&(t.update(i=>({...i,recentlySaved:!0})),setTimeout(()=>{t.update(i=>({...i,recentlySaved:!1}))},3e3)),a=!1},300)}async function y(n){t.update(e=>({...e,...n})),await fetch(`${f}/settings`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...o(t),...n})}),d(u.ConversationList)}const l={subscribe:t.subscribe,set:S,instantSet:y,initValue:p,update:n=>{S(n(o(t)))}};return T("settings",l),l}export{u as U,L as c,x as u};
