import"./Bzak7iHL.js";import{p as Ae,e as w,g as ce,M as He,i as e,h as a,k as V,d as W,a as c,b as Ke,f as h,c as o,r as l,j as ve,s as v,ap as Te,t as G,aq as qe}from"./jB7C_rnE.js";import{d as ze,s as J,b as Be}from"./C8st8IW6.js";import{i as U}from"./Bp5l5fH2.js";import{e as ue,i as fe}from"./B_9GqA3w.js";import{d as me,b as z}from"./CgC7qgJv.js";import{a as Qe}from"./CeoL9yOQ.js";import{p as Ve}from"./D-VCVtW5.js";import{u as We,h as be}from"./DkC0pIUA.js";import{I as Je}from"./rVTgO4vC.js";import{P as Ne}from"./BuGP631s.js";import{C as Ye}from"./DydEdpK0.js";import{I as Ze}from"./BCisTzWU.js";import{U as $e}from"./IYyS0das.js";var er=h("<option>Loading Google models...</option>"),rr=h("<option> </option>"),ar=h("<option> </option>"),tr=h('<div class="mb-4 rounded-lg bg-red-50 p-4 dark:bg-red-900/20"><p class="text-sm text-red-600 dark:text-red-400"> </p></div>'),or=h('<button type="button" class="rounded-lg border border-gray-300 px-3 py-1.5 text-xs font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-600 dark:text-gray-300 dark:hover:bg-gray-800">Remove</button>'),lr=h('<div class="overflow-hidden rounded-lg border border-gray-200 dark:border-gray-700"><img alt="Reference" class="max-h-48 w-full object-contain"/></div>'),ir=h('<label class="flex cursor-pointer items-center justify-center gap-2 rounded-lg border border-dashed border-gray-300 bg-gray-50 px-4 py-5 text-sm text-gray-700 hover:bg-gray-100 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-200 dark:hover:bg-gray-700"><!> <span>Upload a reference image</span> <input type="file" accept="image/*" class="hidden"/></label>'),dr=h('<div class="mt-4"><div class="mb-2 flex items-center justify-between"><p class="text-sm font-medium text-gray-700 dark:text-gray-300">Reference image (optional)</p> <!></div> <!></div>'),nr=h('<span class="flex items-center justify-center gap-2"><!> Generating...</span>'),sr=h('<div class="rounded-lg bg-red-50 p-4 dark:bg-red-900/20"><p class="text-sm text-red-600 dark:text-red-400"> </p></div>'),gr=h('<div class="space-y-4"><div class="overflow-hidden rounded-lg border border-gray-200 dark:border-gray-700"><img class="w-full"/></div> <div class="flex gap-3"><a download="generated-image.png" class="flex-1 rounded-lg border border-gray-300 px-4 py-2 text-center font-medium text-gray-700 transition-colors hover:bg-gray-50 dark:border-gray-600 dark:text-gray-300 dark:hover:bg-gray-800">Download</a> <a class="flex-1 rounded-lg bg-gray-900 px-4 py-2 text-center font-medium text-white transition-colors hover:bg-gray-800 dark:bg-gray-100 dark:text-gray-900 dark:hover:bg-gray-200">View Gallery</a></div></div>'),cr=h('<div class="fixed inset-0 z-[9999] flex items-center justify-center bg-black/50 p-4" role="dialog" aria-modal="true" tabindex="-1"><div class="relative max-h-[85vh] w-full max-w-2xl overflow-y-auto rounded-2xl bg-white shadow-2xl dark:bg-gray-900 svelte-yi78vo" role="document" tabindex="0"><div class="flex items-center justify-between border-b border-gray-200 px-6 py-4 dark:border-gray-800"><div class="flex items-center gap-3"><div class="rounded-lg bg-blue-100 p-2 dark:bg-blue-900"><!></div> <h2 class="text-xl font-semibold text-gray-900 dark:text-gray-100">Generate Image with FLUX</h2></div> <button type="button" class="rounded-lg p-2 text-gray-500 transition-colors hover:bg-gray-100 hover:text-gray-700 dark:text-gray-400 dark:hover:bg-gray-800 dark:hover:text-gray-200" aria-label="Close"><!></button></div> <div class="space-y-6 p-6"><div><label for="image-provider" class="mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300">Provider</label> <select id="image-provider" class="mb-4 w-full rounded-lg border border-gray-300 bg-white px-4 py-3 text-gray-900 shadow-sm transition-all focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-100"><option>Google AI Studio</option><option>HuggingFace</option></select> <label for="image-model" class="mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300">Select Model</label> <select id="image-model" class="mb-4 w-full rounded-lg border border-gray-300 bg-white px-4 py-3 text-gray-900 shadow-sm transition-all focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-100"><!></select> <!> <label for="image-prompt" class="mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300">Image Description</label> <textarea id="image-prompt" placeholder="A beautiful sunset over mountains..." rows="3" class="w-full rounded-lg border border-gray-300 bg-white px-4 py-3 text-gray-900 shadow-sm transition-all placeholder:text-gray-400 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500"></textarea> <p class="mt-1 text-xs text-gray-500 dark:text-gray-400">Press Ctrl+Enter to generate â€¢ Max 500 characters</p> <!></div> <button type="button" class="w-full rounded-lg bg-blue-600 px-6 py-3 font-semibold text-white shadow-md transition-all hover:bg-blue-700 disabled:cursor-not-allowed disabled:opacity-50"><!></button> <!> <!></div></div></div>');function Ur(ye,k){Ae(k,!0);let N=Ve(k,"open",15,!1);const Y=[{id:"black-forest-labs/FLUX.1-schnell",name:"FLUX.1-schnell (Fast & High Quality)"},{id:"stabilityai/stable-diffusion-xl-base-1.0",name:"Stable Diffusion XL (Open Source Leader)"},{id:"ByteDance/SDXL-Lightning",name:"SDXL-Lightning (Ultra Fast)"},{id:"stabilityai/stable-diffusion-2-1",name:"Stable Diffusion 2.1 (Lightweight)"},{id:"playgroundai/playground-v2.5-1024px-aesthetic",name:"Playground v2.5 (Aesthetic Focused)"}];let b=w("google"),R=w(ce([])),X=w(!1),B=w(null),j=w(""),y=w(ce(Y[0].id)),P=w(!1),D=w(null),M=w(null),C=w(null),u=w(null);const Z=We();async function te(){if(!e(X)){a(X,!0),a(B,null);try{const d=await Z.images.google.models.get(),m=be(d);a(R,(m.models||[]).filter(s=>typeof s.id=="string"&&s.id.includes("image")).sort((s,i)=>(i.created??0)-(s.created??0)),!0),e(b)==="google"&&e(R).length>0&&a(y,e(R)[0].id,!0)}catch(d){a(B,String(d),!0)}finally{a(X,!1)}}}async function oe(){var d,m;if(!(!e(j).trim()||e(P))){a(P,!0),a(M,null),a(D,null);try{console.log("Sending request with provider/model:",e(b),e(y));const s=e(b)==="google"?await Z.images.google.generate.post({prompt:e(j).trim(),model:e(y),referenceImage:e(C)??void 0}):await Z.images.generate.post({prompt:e(j).trim(),model:e(y)});console.log("Raw response received:",s);const i=be(s);if(console.log("Parsed response:",i),i!=null&&i.success&&(i!=null&&i.image))a(D,i.image.url,!0),(d=k.onImageGenerated)==null||d.call(k,i.image.url);else throw i!=null&&i.success&&((m=k.onImageGenerated)==null||m.call(k,"")),console.error("Invalid response structure:",i),new Error("Invalid response format. See console for details.")}catch(s){console.error("Image generation failed:",s),a(M,String(s),!0)}finally{a(P,!1)}}}function _e(d){a(b,d,!0),a(D,null),a(M,null),e(b)!=="google"&&(e(u)&&URL.revokeObjectURL(e(u)),a(u,null),a(C,null)),e(b)==="huggingface"?a(y,Y[0].id,!0):e(R).length>0?a(y,e(R)[0].id,!0):te()}function pe(d){const m=d.currentTarget;m&&_e(m.value)}function $(){var d;a(j,""),a(D,null),a(M,null),e(u)&&URL.revokeObjectURL(e(u)),a(u,null),a(C,null),N(!1),(d=k.onClose)==null||d.call(k)}async function xe(d){var E;const m=d.currentTarget,s=(E=m==null?void 0:m.files)==null?void 0:E[0];if(!s)return;if(!s.type.startsWith("image/")){a(C,null),a(u,null),a(M,"Please select an image file");return}a(M,null),a(u,URL.createObjectURL(s),!0);const i=await new Promise((A,H)=>{const F=new FileReader;F.onload=()=>A(String(F.result||"")),F.onerror=()=>H(F.error),F.readAsDataURL(s)});a(C,{data:i,mimeType:s.type},!0)}function he(){e(u)&&URL.revokeObjectURL(e(u)),a(u,null),a(C,null)}function ke(d){d.key==="Escape"&&$()}He(()=>{N()&&(e(R).length===0&&!e(X)&&te(),e(b)==="google"&&e(R).length>0&&!e(y).includes("image")&&a(y,e(R)[0].id,!0))});var le=V(),we=W(le);{var Le=d=>{Ne(d,{children:(m,s)=>{var i=cr();i.__click=$,i.__keydown=ke;var E=o(i);E.__click=r=>r.stopPropagation();var A=o(E),H=o(A),F=o(H),Ie=o(F);Ze(Ie,{class:"text-xl text-blue-600 dark:text-blue-400"}),l(F),ve(2),l(H);var ee=v(H,2);ee.__click=$;var Ue=o(ee);Ye(Ue,{class:"text-xl"}),l(ee),l(A);var ie=v(A,2),re=o(ie),O=v(o(re),2);O.__change=pe;var ae=o(O);ae.value=ae.__value="google";var de=v(ae);de.value=de.__value="huggingface",l(O);var K=v(O,4),Re=o(K);{var Pe=r=>{var t=V(),n=W(t);{var _=g=>{var p=er(),S={};G(()=>{S!==(S=e(y))&&(p.value=(p.__value=e(y))??"")}),c(g,p)},L=g=>{var p=V(),S=W(p);ue(S,17,()=>e(R),fe,(x,f)=>{var I=rr(),Q=o(I,!0);l(I);var ge={};G(()=>{J(Q,e(f).id),ge!==(ge=e(f).id)&&(I.value=(I.__value=e(f).id)??"")}),c(x,I)}),c(g,p)};U(n,g=>{e(X)?g(_):g(L,!1)})}c(r,t)},Se=r=>{var t=V(),n=W(t);ue(n,17,()=>Y,fe,(_,L)=>{var g=ar(),p=o(g,!0);l(g);var S={};G(()=>{J(p,e(L).name),S!==(S=e(L).id)&&(g.value=(g.__value=e(L).id)??"")}),c(_,g)}),c(r,t)};U(Re,r=>{e(b)==="google"?r(Pe):r(Se,!1)})}l(K);var ne=v(K,2);{var Ge=r=>{var t=tr(),n=o(t),_=o(n,!0);l(n),l(t),G(()=>J(_,e(B))),c(r,t)};U(ne,r=>{e(b)==="google"&&e(B)&&r(Ge)})}var T=v(ne,4);Te(T),T.__keydown=r=>{r.key==="Enter"&&(r.ctrlKey||r.metaKey)&&oe()};var je=v(T,4);{var Me=r=>{var t=dr(),n=o(t),_=v(o(n),2);{var L=x=>{var f=or();f.__click=he,c(x,f)};U(_,x=>{e(u)&&x(L)})}l(n);var g=v(n,2);{var p=x=>{var f=lr(),I=o(f);l(f),G(()=>z(I,"src",e(u))),c(x,f)},S=x=>{var f=ir(),I=o(f);$e(I,{class:"text-lg"});var Q=v(I,4);Q.__change=xe,l(f),G(()=>Q.disabled=e(P)),c(x,f)};U(g,x=>{e(u)?x(p):x(S,!1)})}l(t),c(r,t)};U(je,r=>{e(b)==="google"&&r(Me)})}l(re);var q=v(re,2);q.__click=oe;var Fe=o(q);{var De=r=>{var t=nr(),n=o(t);Je(n,{}),ve(),l(t),c(r,t)},Ce=r=>{var t=qe("Generate Image");c(r,t)};U(Fe,r=>{e(P)?r(De):r(Ce,!1)})}l(q);var se=v(q,2);{var Ee=r=>{var t=sr(),n=o(t),_=o(n,!0);l(n),l(t),G(()=>J(_,e(M))),c(r,t)};U(se,r=>{e(M)&&r(Ee)})}var Oe=v(se,2);{var Xe=r=>{var t=gr(),n=o(t),_=o(n);l(n);var L=v(n,2),g=o(L),p=v(g,2);l(L),l(t),G(()=>{z(_,"src",e(D)),z(_,"alt",e(j)),z(g,"href",e(D)),z(p,"href",`${Be??""}/gallery`)}),c(r,t)};U(Oe,r=>{e(D)&&r(Xe)})}l(ie),l(E),l(i),G(r=>{O.disabled=e(P),K.disabled=e(P),T.disabled=e(P),q.disabled=r},[()=>!e(j).trim()||e(P)]),me(O,()=>e(b),r=>a(b,r)),me(K,()=>e(y),r=>a(y,r)),Qe(T,()=>e(j),r=>a(j,r)),c(m,i)},$$slots:{default:!0}})};U(we,d=>{N()&&d(Le)})}c(ye,le),Ke()}ze(["click","keydown","change"]);export{Ur as I};
